<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>POC Jogo da Cobrinha</title>
   <style>
      #screen {
         border: 10px solid #CCC;
         image-rendering: pixelated;
         image-rendering: crisp-edges;
         image-rendering: -moz-crisp-edges;
         width: 400px;
         height: 400px;
      }
   </style>
</head>
<body>
   <canvas id="screen" width="10" height="10"></canvas>

   <script>

      const screen = document.getElementById('screen');
      const context = screen.getContext('2d');

      const game = {
         snake: [
            { x: 1, y: 5 }
         ],
         fruit: { x: 2, y: 2 },
         direction: 'right'
      };

      document.addEventListener('keydown', handleKeydown);

      function handleKeydown(event) {
         const keyPressed = event.key;

         if(keyPressed === 'ArrowUp' && game.direction !== 'down') {            
            game.direction = 'up';
            return
         }

         if(keyPressed === 'ArrowRight' && game.direction !== 'left') {            
            game.direction = 'right';
            return
         }

         if(keyPressed === 'ArrowDown' && game.direction !== 'up') {            
            game.direction = 'down';
            return
         }

         if(keyPressed === 'ArrowLeft' && game.direction !== 'right') {            
            game.direction = 'left';
            return
         }

      }

      function renderScreen() {

         context.fillStyle = 'white';
         context.clearRect(0, 0, 10, 10);

         for(const index in game.snake) {
            context.fillStyle = 'black';
            context.fillRect(game.snake[index].x, game.snake[index].y, 1, 1);
         }

         context.fillStyle = 'red';
         context.fillRect(game.fruit.x, game.fruit.y, 1, 1);            
         
      }

      function handleSnakeMovement() {

         let snake_x = game.snake[0].x;
         let snake_y = game.snake[0].y;

         if(game.direction === 'right') {
            snake_x = snake_x + 1;
         }

         if(game.direction === 'left') {
            snake_x = snake_x - 1;
         }

         if(game.direction === 'down') {
            snake_y = snake_y + 1;
         }

         if(game.direction === 'up') {
            snake_y = snake_y - 1;
         }

         game.snake.pop();         
         game.snake.unshift({ x: snake_x, y: snake_y });          

         if(game.snake[0].x > 9 && game.direction === 'right') {
            game.snake[0].x = 0;
         }

         if(game.snake[0].x < 0 && game.direction === 'left') {
            game.snake[0].x = 9;
         }

         if(game.snake[0].y > 9 && game.direction === 'down') {
            game.snake[0].y = 0;
         }

         if(game.snake[0].y < 0 && game.direction === 'up') {
            game.snake[0].y = 9;
         }
       
      }

      function startGame() {
         renderScreen();
         handleSnakeMovement();      
      } 

      setInterval(startGame, 100);

   </script>

</body>
</html>